// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id Int @default(autoincrement()) @id
  oauthId String @map("oauth_id") @unique
  nickname String
  profileUrl String @map("profile_url")
  role Role @default(MEMBER)
  createdAt DateTime @map("created_at") @default(now())
  updatedAt DateTime @map("updated_at") @updatedAt
  boardGameScores BoardGameScore[]
  boardGameReplies BoardGameReply[]

  @@map("user")
}

model BoardGame {
  id  Int @default(autoincrement()) @id
  name String
  description String
  thumbnailUrl String @map("thumbnail_url")
  designer String
  difficulty Float
  personnel String
  recommendPersonnel String @map("recommend_personnel")
  playTime Int // 분 단위
  age Int // 10 => 10세 이상
  createdAt DateTime @map("created_at") @default(now())
  updatedAt DateTime @map("updated_at") @updatedAt
  boardGameGenres BoardGameGenre[]
  boardGameScores BoardGameScore[]
  boardGameReplies BoardGameReply[]

  @@map("board_game")
}

model BoardGameGenre {
  id Int @default(autoincrement()) @id
  boardGameId Int @map("board_game_id")
  genreId Int @map("genre_id")
  createdAt DateTime @map("created_at") @default(now())
  updatedAt DateTime @map("updated_at") @updatedAt
  boardGame BoardGame @relation(fields: [boardGameId], references: [id])
  genre Genre @relation(fields: [genreId], references: [id])

  @@map("board_game_genre")
}

model Genre {
  id Int @default(autoincrement()) @id
  code String @unique // STRATEGY, ABSTRACT, WITS, BATTLE, REASONING, CARD, TILE, THEME 
  name String // 전략, 추상, 순발력, 전투, 추리, 카드게임, 타일, 테마
  order Int
  createdAt DateTime @map("created_at") @default(now())
  updatedAt DateTime @map("updated_at") @updatedAt 
  boardGameGeneres BoardGameGenre[]

  @@map("genre")
}

model BoardGameScore {
  id Int @default(autoincrement()) @id
  score Int
  userId Int @map("user_id")
  boardGameId Int @map("board_game_id")
  createdAt DateTime @map("created_at") @default(now())
  updatedAt DateTime @map("updated_at") @updatedAt
  boardGame BoardGame @relation(fields: [boardGameId], references: [id])
  user User @relation(fields: [userId], references: [id])

  @@map("board_game_score")
}

model BoardGameReply {
  id Int @default(autoincrement()) @id
  content String
  userId Int @map("user_id")
  boardGameId Int @map("board_game_id")
  createdAt DateTime @map("created_at") @default(now())
  updatedAt DateTime @map("updated_at") @updatedAt
  boardGame BoardGame @relation(fields: [boardGameId], references: [id])
  user User @relation(fields: [userId], references: [id])

  @@map("board_game_reply")
}

enum Role {
  ADMIN
  MEMBER
}